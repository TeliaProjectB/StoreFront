/*
Author: Elias Fredin
License:public domain
Manual: https://github.com/Bravos123/pretty-file-system/blob/master/README.md
Description: Creates a simple and pretty file explorer.
License: https://creativecommons.org/publicdomain/mark/1.0/
*/
var prettyFiles=function(){var z=function(){return{init:function(r,m){function n(c){c.preventDefault()}function d(c){var a=document.createElement("div");a.className="fileExplorerMiniMenu editFolderItem";c.appendChild(a)}this.createFolder=function(c){var a=document.createElement("div");a.addEventListener("contextmenu",n);var b=document.createElement("div");b.name="flexContainer";b.className="fileExplorerItem";var k=document.createElement("div");k.className="fileExplorerImagePreview fileExplorerFolderClosed fileExplorerContainBack";
b.appendChild(k);k=document.createElement("span");k.className="fileExplorerSpan";k.innerHTML=c.name;b.appendChild(k);m.params.disableInteraction||d(b);a.appendChild(b);c.elemContainer.style.display="none";c.elemContainer.style.marginLeft="16px";a.appendChild(c.elemContainer);return a};this.createFile=function(c){var a=document.createElement("div");a.className="fileExplorerItem";a.addEventListener("contextmenu",n);var b=document.createElement("div");b.removeAttribute("style");b.className="fileExplorerImagePreview fileExplorerContainBack";
void 0!==c.image&&""!==c.image.replace(/ /g,"")?b.style.backgroundImage="url('"+c.image+"')":b.className+=" fileExplorerFile";a.appendChild(b);b=document.createElement("span");b.className="fileExplorerSpan";b.innerHTML=c.name;a.appendChild(b);m.params.disableInteraction||d(a);return a}}}}();var y=function(){return{init:function(r,m,n,d){function c(a,c,d){for(var b=a.name,g=a.id,h=0;h<n.sharedResourceFolderJs.length;h++){var k=n.sharedResourceFolderJs[h].getHashes()[g].element;k.parentElement.removeChild(k)}for(h=
0;h<c.content.length;h++)if(c.content[h].id==a.id){c.content.splice(h,1);break}c=c.elemContainer.children;for(h=0;h<c.length;h++)if(c[h]==a.element){c[h].parentElement.removeChild(c[h]);break}if(d)m.onDeleteFile(b,g)}function a(b,d){for(var k=b.selectedItem.name,f=b.selectedItem.content.length-1;0!=f;f--)"folder"==b.selectedItem.content[f].type?a(b.selectedItem.content[f],d):c(b.selectedItem.content[f],b.selectedItem.content[f].parent,d);for(f=b.selectedItem.parent.content.length-1;0!=f;f--)"folder"==
b.selectedItem.parent.content[f].type&&b.selectedItem.parent.content[f].name==b.selectedItem.name&&b.selectedItem.parent.content.splice(f,1);for(f=0;f<n.namesOfFolders.length;f++)n.namesOfFolders[f]==k&&n.namesOfFolders.splice(f,1)}this["delete"]=function(b){void 0!=b.selectedItem&&void 0==b.selectedItem.root&&("folder"==b.selectedItem.type?r.confirm("Delete",'Are you sure you want to delete the folder "'+b.selectedItem.name+"\" and all it's content?",function(k){k&&(delete b.hashedEntries[b.selectedItem.id],
a(b,!0),c(b.selectedItem,b.selectedItem.parent,!0),b.selectedItem=d)}):r.confirm("Delete",'Are you sure you want to delete the file "'+b.selectedItem.name+'"?',function(a){a&&(delete b.hashedEntries[b.selectedItem.id],c(b.selectedItem,b.selectedItem.parent,!0),b.selectedItem=d)}))}}}}();var x=function(){return{init:function(r){function m(a,b){a.element.parentElement.removeChild(a.element);a.parent.content.splice(a.parent.content.indexOf(a),1);a.parent=void 0==b.content?b.parent:b;a.parent.elemContainer.appendChild(a.element);
a.parent.content.push(a)}function n(a){for(var b=a.element.parentElement,d=b.children,l=0,f=0;f<d.length;f++)if(d[f]==a.element){l=f-1;0>l&&(l=0);break}a.element.parentElement.removeChild(a.element);b.insertBefore(a.element,d[l]);c(a.parent.content,a,-1)}function d(a){for(var b=a.element.parentElement,d=b.children,l=0,f=0;f<d.length;f++)if(d[f]==a.element){l=f+1;l>d.length-1&&(l=d.length-1);break}a.element.parentElement.removeChild(a.element);b.insertBefore(a.element,d[l]);c(a.parent.content,a,1)}
this.moveItem=function(a,b,c){m(a,b);for(var d=0;d<c.sharedResourceFolderJs.length;d++){var f=c.sharedResourceFolderJs[d].getHashes()[b.id];void 0==f&&(f=c.sharedResourceFolderJs[d].getRoot());m(c.sharedResourceFolderJs[d].getHashes()[a.id],f)}};this.moveItemUp=function(a){n(a);for(var b=0;b<r.sharedResourceFolderJs.length;b++)n(r.sharedResourceFolderJs[b].getHashes()[a.id])};this.moveItemDown=function(a){d(a);for(var b=0;b<r.sharedResourceFolderJs.length;b++)d(r.sharedResourceFolderJs[b].getHashes()[a.id])};
var c=function(a,b,c){b=a.indexOf(b);c=b+c;0>c||c==a.length||(c=[b,c].sort(),a.splice(c[0],2,a[c[1]],a[c[0]]))}}}}();y=function(r,m){return{init:function(n,d,c,a){function b(){u=!0;e.element.getElementsByClassName("editFolderItem")[0].style.webkitFilter="none";e.element.getElementsByClassName("editFolderItem")[0].style.filter="none";e.element.getElementsByClassName("editFolderItem")[0].appendChild(q);for(var a=0;a<q.children.length;a++)q.children[a].className="fileExplorerMenuEntry fileExplorerMenuC1";
window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty();c.root.elemContainer.addEventListener("mouseup",l,!0);setTimeout(function(){document.body.addEventListener("mouseup",l,!1);document.body.addEventListener("touchend",l,!1)},45)}function k(){u=!1;try{e.element.getElementsByClassName("editFolderItem")[0].removeAttribute("style"),e.element.getElementsByClassName("editFolderItem")[0].removeChild(q)}catch(w){}document.body.removeEventListener("mouseup",
l,!1);document.body.removeEventListener("touchend",l,!1);c.root.elemContainer.removeEventListener("mouseup",l,!0)}function l(a){for(var b=q.children,c=!1,w=0;w<b.length;w++)if(a.target==b[w]){c=!0;break}c||a.target==q||k()}function f(a,b){var c=document.createElement("div");c.className="fileExplorerMenuEntry";c.innerHTML=a;c.addEventListener("mouseup",function(){b()});q.appendChild(c);return c}function g(a,b){if(c.params.onlyUniqueNames)for(var w=Object.keys(c.hashedEntries),p=0;p<w.length;p++)if(c.hashedEntries[w[p]].name==
b)return!0;for(p=0;p<a.length;p++)if(a[p].name==b)return!0;return!1}var h=new m.init(c),u=!1,e,t=new r.init(d,n,c,a);a=document.createElement("button");a.className="fileOptionButton";a.innerHTML="Cancel";a.onclick=function(){e.element.style.opacity="1";c.draging=void 0;c.movingIndicator.style.display="none";void 0!=c.buttonCreateItems&&(c.buttonCreateItems.style.display="block")};void 0!=c.movingIndicator&&c.movingIndicator.appendChild(a);a=document.createElement("button");a.className="fileOptionButton";
a.innerHTML="Place";a.onclick=function(){e.element.style.opacity="1";c.draging=void 0;c.movingIndicator.style.display="none";var a=!0;void 0==c.selectedItem.content?(e.id==c.selectedItem.parent.id&&(a=!1),void 0!=c.selectedItem.parent.root&&void 0!=e.parent.root&&(a=!1)):(e.id==c.selectedItem.id&&(a=!1),void 0!=c.selectedItem.root&&void 0!=e.parent.root&&(a=!1));var b=void 0==c.selectedItem.content?c.selectedItem.parent:c.selectedItem;for(var p=0;p<b.content.length;p++)if(b.content[p].name==e.name){a=
!1;b.content[p].id!=e.id&&d.alert("Alert","There already exists an item with that name in target folder.");break}a&&h.moveItem(e,c.selectedItem,c);void 0!=c.buttonCreateItems&&(c.buttonCreateItems.style.display="block");c.movingIndicator.className="fileExplorerMI"};void 0!=c.movingIndicator&&c.movingIndicator.appendChild(a);var q=document.createElement("div");q.className="fileExplorerMenu";f("Move",function(){q.getBoundingClientRect();k();e.element.style.opacity="0.36";c.mouseDrag=!1;c.draging=e;
void 0!=c.buttonCreateItems&&(c.buttonCreateItems.style.display="none");c.movingIndicator.style.display="inline-block"});f("Rename",function(){k();d.prompt("Rename","Enter a new name: ","Name",function(a){if(null!=a){for(var b=0,p=a;g(e.parent.content,p);)p=b+"_"+a,b++;for(a=0;a<c.sharedResourceFolderJs.length;a++)b=c.sharedResourceFolderJs[a].getHashes()[e.id],b.name=p,b.element.getElementsByTagName("span")[0].innerHTML=p;n.onRenameItem(e.name,e.id,p);e.name=p;e.element.getElementsByTagName("span")[0].innerHTML=
p}})});f("Delete",function(){k();c.selectedItem=e;t["delete"](c)});var p=f("Duplicate",function(){k();d.prompt("Copy","Enter a name for the copy: ",e.name,function(a){if(null!=a){a==e.name&&(a=e.name);for(var b=0,p=a;g(e.parent.content,p);)p=b+"_"+a,b++;c.selectedItem=e;n.sticker=e.image;n.createFile(p);n.onDuplicateFile(e.name,e.id,p,c.newlyCreatedFile.id)}})});f("Move up",function(){k();h.moveItemUp(e);n.onMoveItemUp(e.name,e.id)});f("Move down",function(){k();h.moveItemDown(e);n.onMoveItemDown(e.name,
e.id)});this.open=function(a){void 0==c.draging&&(c.holding=!1,u&&k(),e=a,b(),p.style.display="folder"==e.type?"none":"block")};this.closeMenu=function(){k()}}}}(y,x);var A=function(){return{init:function(){function r(a){m.style.top=a.clientY+"px";m.style.left=a.clientX+"px"}var m=document.createElement("div");m.className="fileExplorerGhost";m.style.zIndex="99999999";var n=document.createElement("div");n.className="fileExplorerImagePreview";m.appendChild(n);var d=document.createElement("span");d.className=
"fileExplorerSpan";m.appendChild(d);var c=!1;this.createGhost=function(a){d.innerHTML=a.name;m.style.width=a.element.offsetWidth+"px";"file"==a.type?(n.className="fileExplorerImagePreview fileExplorerContainBack",n.style.backgroundImage="url('"+a.element.getElementsByTagName("div")[0].src+"')"):"folder"==a.type&&(n.removeAttribute("style"),n.className="fileExplorerImagePreview fileExplorerContainBack fileExplorerFolderClosed");document.body.appendChild(m);document.body.addEventListener("mousemove",
r);c=!0};this.killGhost=function(){c&&(c=!1,document.body.removeEventListener("mousemove",r),document.body.removeChild(m))}}}}();x=function(r,m,n){return{init:function(d,c,a,b){function k(a,b){a.addEventListener("mouseup",b)}function l(a,b){return void 0!=a.parent?a.parent.id==b.id?!0:l(a.parent,b):!1}function f(a){a.element.addEventListener("mousedown",function(c){c.stopPropagation();void 0==b.draging&&(b.holding=a.id,b.mouseDrag=!0)});a.element.addEventListener("mouseup",function(a){a.stopPropagation();
b.holding=!1});a.element.addEventListener("mouseleave",function(c){!1!==b.holding&&void 0==b.draging&&b.mouseDrag&&(b.draging=b.hashedEntries[b.holding],b.buttonCreateItems.style.display="none",t.createGhost(b.draging),q.closeMenu(),h(a,"fileExplorerItem"));b.holding=!1});a.element.addEventListener("mousemove",function(c){void 0!=b.draging&&b.mouseDrag?h(a,"fileExplorerDragLight"):b.selectedItem.id==a.id?h(a,"fileExplorerItemSelectedColor"):h(a,"fileExplorerItem")})}function g(a){void 0!=a&&void 0!=
a.element&&h(a,"fileExplorerItem")}function h(a,b){"file"==a.type?a.element.className!=b&&(a.element.className=b):"folder"==a.type&&a.element.className!=b&&(a.element.childNodes[0].className=b)}function u(a,b,c){a.addEventListener("mouseup",b,c);a.addEventListener("touchend",b,c)}var e=new m.init,t=new n.init,q=new r.init(c,a,b,d);d.elemContainer.addEventListener("mouseup",function(a){b.params.disableInteraction||(void 0!=b.draging&&1==b.mouseDrag&&e.moveItem(b.draging,d,b),b.draging=void 0,b.selectedItem=
d,t.killGhost(),b.buttonCreateItems.style.display="block",d.elemContainer.className="fileExplorerRootCon")});this.addListenerFolder=function(a){k(a.element,function(c){c.stopPropagation();void 0==b.draging||0==b.mouseDrag?(g(b.selectedItem),a.open?(a.open=!1,a.elemContainer.style.display="none",c=a.element.getElementsByTagName("div")[0],c.getElementsByTagName("div")[0].className="fileExplorerImagePreview fileExplorerFolderClosed fileExplorerContainBack",c.className="fileExplorerItem",b.selectedItem=
d):(a.open=!0,a.elemContainer.style.display="block",c=a.element.getElementsByTagName("div")[0],c.getElementsByTagName("div")[0].className="fileExplorerImagePreview fileExplorerFolderOpened fileExplorerContainBack",c.className="fileExplorerItemSelectedColor",b.selectedItem=void 0!=b.selectedItem?a:d)):(b.draging.id==a.id||l(a,b.draging)||e.moveItem(b.draging,a,b),h(a,"fileExplorerItem"),b.draging=void 0,b.selectedItem=d,t.killGhost(),b.buttonCreateItems.style.display="block")});b.params.disableInteraction||
f(a);void 0!=a.element.getElementsByClassName("editFolderItem")[0]&&u(a.element.getElementsByClassName("editFolderItem")[0],function(b){b.stopPropagation();q.open(a)},!1)};this.addListenerToFile=function(a){k(a.element,function(f){f.stopPropagation();b.holding=!1;void 0==b.draging||0==b.mouseDrag?(g(b.selectedItem),b.selectedItem.id==a.id&&void 0!=b.selectedItem?(b.selectedItem=d,a.element.className="fileExplorerItem"):(b.selectedItem=void 0!=b.selectedItem?a:d,c.onClickFile(a.name,a.id,a.image,a.customData),
a.element.className="fileExplorerItemSelectedColor",b.selectedItem=a)):(b.draging.id==a.id||l(a,b.draging)||e.moveItem(b.draging,a,b),h(a,"fileExplorerItem"),b.draging=void 0,b.selectedItem=d,b.buttonCreateItems.style.display="block",t.killGhost())});b.params.disableInteraction||f(a);void 0!=a.element.getElementsByClassName("editFolderItem")[0]&&u(a.element.getElementsByClassName("editFolderItem")[0],function(b){b.stopPropagation();q.open(a)},!1)}}}}(y,x,A);z=function(r,m){return{init:function(n,
d,c,a){function b(){this.id;this.type="folder";this.name="";this.open=!1;this.parent;this.content=[];this.elemContainer=document.createElement("div");this.image;this.element}function k(){this.id;this.type="file";this.name="";this.parent;this.contains=void 0;this.metaData=[];this.onclick=this.customData=void 0;this.element;this.image=void 0}function l(b,c,g,p){"folder"==b?d.prompt("Create folder","Enter a name for the folder:","Folder name",function(h){if(null!=h&&""!=h.replace(/ /g,"")){var e=!1;
if(a.params.onlyUniqueNames)for(var v=0;v<a.namesOfFolders.length;v++)if(a.namesOfFolders[v]==h){e=!0;break}e?(e="An item with that name already exists",""==h.replace(/ /g,"")&&(e="Invalid name"),d.alert("Error",e,function(){g&&l(b,c,g,p)})):(f(h,!0),a.namesOfFolders.push(h))}else g&&l(b,c,g,p)}):d.prompt("Create "+a.params.itemName,"Enter a name:","File name",function(f){if(null!=f&&""!=f.replace(/ /g,"")){var v=!1;a.params.onlyUniqueNames&&e(f)&&(v=!0);v?(v="An item with that name already exists",
""==f.replace(/ /g,"")&&(v="Invalid name"),d.alert("Error",v,function(){g&&l(b,c,g,p)})):h(f,!0)}else g&&l(b,c,g,p)})}function f(h,g){void 0==a.selectedItem&&(a.selectedItem=n);var e=new b;e.id=a.idCounter;e.name=h;e.parentContainer=a.selectedItem;e.element=p.createFolder(e);if(void 0==a.selectedItem.content){if(t(a.selectedItem.parent.content,h)&&g){d.alert("Alert","There already exists a folder with that name in target folder.");return}a.selectedItem.parent.content.push(e);e.parent=a.selectedItem.parent;
a.selectedItem.parent.elemContainer.appendChild(e.element)}else{if(t(a.selectedItem.content,h)&&g){d.alert("Alert","There already exists a folder with that name in target folder.");return}a.selectedItem.content.push(e);e.parent=a.selectedItem;a.selectedItem.elemContainer.appendChild(e.element)}a.idCounter++;q.addListenerFolder(e);for(var f=0;f<a.sharedResourceFolderJs.length;f++)void 0!=e.parent.root?a.sharedResourceFolderJs[f].selectItemFromReference(void 0):a.sharedResourceFolderJs[f].selectItemFromReference(a.sharedResourceFolderJs[f].getHashes()[e.parent.id]),
a.sharedResourceFolderJs[f].createFolder(h);if(g)c.onCreatedFileSuccess();a.hashedEntries[e.id]=e;a.namesOfFolders.push(e.name);return e}function g(b,e,f){if(null==b)d.prompt("Create file","Enter a name for the file:","File name",function(a){null!=a&&""!=a.replace(/ /g,"")&&g(a,e,f)});else if(void 0==a.selectedItem&&(a.selectedItem=n),e)if(null!=c.onCreateNewFile)c.onCreateNewFile(b,a.idCounter,function(){return h(b,e,f)});else h(b,e,f);else h(b,e,f)}function h(b,e,h){var g=new k;g.image=c.sticker;
g.id=a.idCounter;g.name=b;g.contains=a.selectedItem;g.customData=h;g.element=p.createFile(g);if(void 0==a.selectedItem.content){if(u(a.selectedItem.parent.content,b)&&e)return d.alert("Alert","There already exists an item with that name in target folder."),!1;a.selectedItem.parent.content.push(g);g.parent=a.selectedItem.parent;a.selectedItem.parent.elemContainer.appendChild(g.element)}else{if(u(a.selectedItem.content,b)&&e)return d.alert("Alert","There already exists an item with that name in target folder."),
!1;a.selectedItem.content.push(g);g.parent=a.selectedItem;a.selectedItem.elemContainer.appendChild(g.element)}if(e)c.onCreatedFileSuccess();a.idCounter++;q.addListenerToFile(g);for(e=0;e<a.sharedResourceFolderJs.length;e++)void 0!=g.parent.root?a.sharedResourceFolderJs[e].selectItemFromReference(void 0):a.sharedResourceFolderJs[e].selectItemFromReference(a.sharedResourceFolderJs[e].getHashes()[g.parent.id]),a.sharedResourceFolderJs[e].sticker=c.sticker,a.sharedResourceFolderJs[e].createFile(b);c.sticker=
void 0;a.hashedEntries[g.id]=g;a.newlyCreatedFile=g;return!0}function u(b,c){if(a.params.onlyUniqueNames&&e(c))return!0;for(var g=0;g<b.length;g++)if(b[g].name==c)return console.log("here2 "),!0;return!1}function e(b){for(var c=Object.keys(a.hashedEntries),g=0;g<c.length;g++)if(a.hashedEntries[c[g]].name==b)return!0;return!1}function t(b,c){if(a.params.onlyUniqueNames)for(var g=0;g<a.namesOfFolders.length;g++)if(a.namesOfFolders[g]==c)return!0;for(g=0;g<b.length;g++)if(b[g].name==c)return!0;return!1}
var q=new m.init(n,c,d,a),p=new r.init(n,a);this.createFolder=function(a){return f(a,!1)};this.createFile=function(a,b,c){g(a,b,c)};this.userCreateItem=function(a,b,c,g){l(a,b,c,g)}}}}(z,x);x=function(){return{init:function(){function r(b,g,f,k){document.body.appendChild(l);a();e.value=f;e.style.display="block";q.style.display="inline";h.innerHTML=b;u.innerHTML=g;t.innerHTML="Okay";q.innerHTML="Cancel";t.onclick=function(){m()};q.onclick=function(){d(function(){document.body.removeChild(l);void 0!=
k&&k(null)})};c();setTimeout(function(){var a=document.getElementById("inputTextPrompt");a.setSelectionRange(0,a.value.length);a.focus()},25)}function m(){d(function(){document.body.removeChild(l);if(void 0!=k){k(e.value);for(var a=0;a<b.length;a++)b[a]()}})}function n(b,g,f){document.body.appendChild(l);a();e.style.display="none";q.style.display="inline";h.innerHTML=b;u.innerHTML=g;t.innerHTML="Yes";q.innerHTML="No";t.onclick=function(){d(function(){document.body.removeChild(l);f(!0)})};q.onclick=
function(){d(function(){document.body.removeChild(l);f(!1)})};c()}function d(a){f.style.transition="top 0.4s";f.style.top="-"+f.clientHeight+"px";l.style.opacity="0";setTimeout(function(){a()},400)}function c(){f.style.transition="top 0.4s";setTimeout(function(){f.style.top="0px"},50)}function a(){f.style.transition="";f.style.top="-"+f.clientHeight+"px";l.style.transition="opacity 0.5s";l.style.opacity="1"}var b=[],k,l=document.createElement("div");l.className="fileExplorerPromptBackdrop";var f=
document.createElement("div");f.className="fileExplorerPromptTopColor";var g=document.createElement("div");g.className="fileExplorerPromptContainer";var h=document.createElement("h2");h.className="fileExplorerPromptHeader";var u=document.createElement("p");u.className="fileExplorerPromptPara";var e=document.createElement("input");e.id="inputTextPrompt";e.type="text";e.className="fileExplorerParaInputText";var t=document.createElement("button");t.className="fileOptionButton";var q=document.createElement("button");
q.className="fileOptionButton";q.style["float"]="right";g.appendChild(h);g.appendChild(u);g.appendChild(e);g.appendChild(t);g.appendChild(q);f.appendChild(g);l.appendChild(f);this.setFunctionExecOnComplete=function(a){b.push(a)};this.prompt=function(a,b,c,g){k=g;void 0==g?r("",a,b,c):r(a,b,c,g)};e.addEventListener("keyup",function(a){13==(a.keyCode?a.keyCode:a.which)&&m()},!1);this.alert=function(b,g,f){document.body.appendChild(l);a();e.style.display="none";q.style.display="none";void 0==g?(h.innerHTML=
"Error:",u.innerHTML=b):(h.innerHTML=b,u.innerHTML=g);t.innerHTML="Okay";q.innerHTML="Cancel";t.onclick=function(){d(function(){document.body.removeChild(l);void 0!=f&&f()})};q.onclick=function(){};c()};this.confirm=function(a,b,c){void 0==c?n("",a,b):n(a,b,c)}}}}();y=function(){return{init:function(r,m,n){this.parseMetaData=function(d,c){for(var a=0;a<c.length;a++)if("folder"==c[a].type){m.selectedItem=d;var b=n.createFolder(c[a].name);m.namesOfFolders.push(c[a].name);this.parseMetaData(b,c[a].contains)}else"file"==
c[a].type&&(m.selectedItem=d,r.sticker=c[a].image,n.createFile(c[a].name,!1,c[a].customData))};this.applyItemClass=function(d,c){"file"==d.type?d.element.className!=c&&(d.element.className=c):"folder"==d.type&&d.element.className!=c&&(d.element.childNodes[0].className=c)};this.deSelectItem=function(d){void 0!=d&&void 0!=d.element&&this.applyItemClass(d,"fileExplorerItem")};this.deSelect=function(){this.deSelectItem(m.selectedItem)};this.selectFile=function(d,c){this.deSelectItem(m.selectedItem);if(!("number"==
typeof c&&0>c)){if("string"==typeof c)for(var a=0;a<m.idCounter;a++){if(void 0!=m.hashedEntries[a]&&m.hashedEntries[a].name==c){var b=m.hashedEntries[a].id;break}}else b=c;void 0!=b&&void 0!=m.hashedEntries[b]&&"file"==m.hashedEntries[b].type&&(m.selectedItem=m.hashedEntries[b],this.applyItemClass(m.selectedItem,"fileExplorerItemSelectedColor"))}};this.checkForName=function(d,c,a){for(var b=0;b<d.length;b++){if("folder"==d[b].type)return this.checkForName(d[b].content,c,a);if("file"==d[b].type){if(c.v===
a)return d[b].name;c.v++}}};this.parseContentToMeta=function(d,c){for(var a=0;a<c.length;a++){if("folder"==c[a].type){var b={type:c[a].type,name:c[a].name,contains:[],id:c[a].id};this.parseContentToMeta(b.contains,c[a].content)}else"file"==c[a].type&&(b=void 0,void 0!=c[a].image&&(b=c[a].image),b={type:c[a].type,name:c[a].name,id:c[a].id,image:b});d.push(b)}};this.appendTopBarContainer=function(d,c,a,b){var k=document.createElement("div");k.className="fileExplorerTopCon";c&&(b.buttonCreateItems=document.createElement("div"),
b.buttonCreateItems.style.textAlign="center",b.buttonCreateItems.style.width="100%",c=document.createElement("button"),c.className="fileOptionButton fileOptionCreateFile",c.innerHTML="Create "+a,c.addEventListener("mouseup",function(){r.createFile(null,!0)}),b.buttonCreateItems.appendChild(c),a=document.createElement("button"),a.className="fileOptionButton fileOptionCreateFolder",a.innerHTML="Create folder",a.addEventListener("mouseup",function(){n.userCreateItem("folder")}),b.buttonCreateItems.appendChild(a),
k.appendChild(b.buttonCreateItems));b.movingIndicator.className="fileExplorerMI";k.appendChild(b.movingIndicator);d.appendChild(k)}}}}();return function(r,m,n){return{init:function(){function d(){for(var b=c.elemContainer;b.firstChild;)b.removeChild(b.firstChild);a.idCounter=0;c.content.length=0;a.namesOfFolders.length=0;a.hashedEntries.length=0}var c={root:!0,content:[],elemContainer:document.createElement("div")};c.elemContainer.className="fileExplorerRootCon";var a={selectedItem:c,sharedResourceFolderJs:[],
hashedEntries:[],movingIndicator:document.createElement("div"),buttonCreateItems:void 0,root:c,draging:void 0,holding:!1,mouseDrag:!1,idCounter:0,params:void 0,namesOfFolders:[],newlyCreatedFile:void 0},b=new m.init,k={getContent:function(){return c.content},setDivContainer:function(a){a.appendChild(k.thisMainContainer)},thisMainContainer:void 0,getHashes:function(){return a.hashedEntries},setSharedResources:function(b){a.sharedResourceFolderJs.push(b)},getRoot:function(){return c},selectItemFromReference:function(b){a.selectedItem=
b},setIdCounter:function(b){a.idCounter=b},reset:function(){d()},sticker:void 0,updateFileImage:function(b,c){if("string"==typeof b){for(var g=!1,e=0;e<a.idCounter;e++)if(void 0!=a.hashedEntries[e]&&a.hashedEntries[e].name==b){var h=a.hashedEntries[e].id;g=!0;break}if(!g)return}else h=b;if(void 0!=a.hashedEntries[h]){if("file"==a.hashedEntries[h].type)for(a.hashedEntries[h].element.getElementsByTagName("div")[0].style.backgroundImage="url('"+c+"')",a.hashedEntries[h].image=c,e=0;e<a.sharedResourceFolderJs.length;e++)a.sharedResourceFolderJs[e].getHashes()[h].element.getElementsByTagName("div")[0].style.backgroundImage=
"url('"+c+"')",a.sharedResourceFolderJs[e].getHashes()[h].image=c;k.sticker=void 0}},getNameAtPosition:function(a){return f.checkForName(c.content,{v:0},a)},insertData:function(b){void 0==b?console.warn("Inserted data is undefined"):(0!=b.length&&""!=b.replace(/ /g,"")&&(b=JSON.parse(b),f.parseMetaData(c,b)),a.selectedItem=c)},getStructure:function(a){var b=[];f.parseContentToMeta(b,c.content);return!0===a?JSON.stringify(b):b},createFolder:function(a){return l.createFolder(a)},createFile:function(a,
b,c){l.createFile(a,b,c)},selectItem:function(a){f.selectFile(c,a)},deSelect:function(){f.deSelect()},flush:function(){d();for(var b=0;b<a.sharedResourceFolderJs.length;b++)a.sharedResourceFolderJs[b].reset()},prompt:function(a,c,d,e){b.prompt(a,c,d,e)},alert:function(a,c,d){b.alert(a,c,d)},confirm:function(a,c,d){b.confirm(a,c,d)},onCreatedFileSuccess:function(){},onMoveItemUp:function(a,b){},onMoveItemDown:function(a,b){},onDuplicateFile:function(a,b,c,e){},onClickFile:function(a,b,c,e){},onCreateNewFile:null,
onRenameItem:function(a,b,c){},onDeleteFile:function(a,b){}},l=new r.init(c,b,k,a),f=new n.init(k,a,l);this.getInit=function(b,d){d.itemName=void 0==d.itemName?"File":d.itemName;d.disableInteraction=void 0==d.disableInteraction?!1:d.disableInteraction;d.onlyUniqueNames=void 0==d.onlyUniqueNames?!1:d.onlyUniqueNames;d.createItemButtonOn=void 0==d.createItemButtonOn?!0:d.createItemButtonOn;d.mirror=void 0==d.mirror?null:d.mirror;null!=d.mirror&&(0==d.mirror.getRoot().content.length?(d.disableInteraction=
!0,d.onlyUniqueNames=!1,d.createItemButtonOn=!1):(d.mirror=null,console.log("Both file explorers must be empty before they can be connected through mirroring.")));a.params=d;void 0!=b?"string"==typeof b&&(b=document.getElementById(b)):b=document.createElement("div");k.thisMainContainer=b;var g=document.createElement("div");g.className="fileExplorerItemContainer fileExplorerSize";b.className="fileExplorerContainer fileExplorerImage";d.disableInteraction||f.appendTopBarContainer(b,d.createItemButtonOn,
d.itemName,a);b.appendChild(g);g.appendChild(c.elemContainer);null!=d.mirror&&d.mirror.setSharedResources(k);return k}}}}(z,x,y)}();